"use strict";window.$Drag=function(t){var b,o,C=this,D=t.type?t.type:"all",q=t.dragObj,z=t.container?t.container:document;t.callBack&&(b=t.callBack.move?t.callBack.move:null,o=t.callBack.end?t.callBack.end:null),this.startDrag=function(t){t.stopPropagation();var w=$pm.zoomRate?$pm.zoomRate:1,R="touchstart"==t.type?t.touches[0].clientY:t.clientY,k="touchstart"==t.type?t.touches[0].clientX:t.clientX,X=q.offsetTop,Y=q.offsetLeft;function e(t){var e="touchmove"==t.type?t.touches[0].clientY:t.clientY,n="touchmove"==t.type?t.touches[0].clientX:t.clientX,o=(e-R)/w+X,i=(n-k)/w+Y;C.newY=o,C.newX=i;var c,a,r,s,u,d,l,v,m,p,h,g,f,y,L,E=void 0,B=void 0;q.dataset.popupPage&&(a=(c=z.querySelector("#wrap")).querySelector("header"),r=c.querySelector("main"),s=c.getBoundingClientRect(),u=a&&a.getBoundingClientRect(),d=r.getBoundingClientRect(),l=q.getBoundingClientRect(),v=u?u.top:d.top,v-=s.top,m=d.left-s.left,p=d.width-l.width,h=d.bottom-l.height,(f=i*w)<=m&&(B=m/w),p<=f&&(B=p/w),(g=o*w)<=v&&(E=v/w),h<=g&&(E=h/w)),"horizon"!==D&&(y=void 0===E?o:E,q.style.top=parseInt(y)+"px"),"vertical"!==D&&(L=void 0===B?i:B,q.style.left=parseInt(L)+"px"),b&&b(C)}function n(){console.log("end()"),z.removeEventListener("mousemove",e),z.removeEventListener("touchmove",e),document.removeEventListener("mouseup",n),document.removeEventListener("touchend",n),o&&o(C)}q.style.transition="none",z.addEventListener("mousemove",e),z.addEventListener("touchmove",e),document.addEventListener("mouseup",n),document.addEventListener("touchend",n)},q.addEventListener("mousedown",this.startDrag.bind(this)),q.addEventListener("touchstart",this.startDrag.bind(this)),z.addEventListener("touchstart",function(t){t.stopPropagation()})};