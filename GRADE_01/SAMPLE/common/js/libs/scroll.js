"use strict";!function(){function y(t){var e=t.target.hasAttribute("data-speaker")||t.target.hasAttribute("data-toggle-target")||t.target.hasAttribute("data-toggle-obj"),n="textarea"===t.target.tagName.toLowerCase();return"input"===t.target.tagName.toLowerCase()||n||e}function e(t){var i=this,e={};this.container=t.container,this.inner=t.inner,this.content=t.content,this.isReset="false"!=t.reset,this.wheelValue=t.value?t.value:20,this.type=t.type&&""!==t.type?t.type:"vertical",this.wheelData=0,this.data={},this.createControl=function(){this.handleContainer=$ts.ce({tag:"div",class:"scroll_handleContainer "+this.type,parent:this.container}),this.bar=$ts.ce({tag:"div",class:"scroll_bar",parent:this.handleContainer}),this.handler=$ts.ce({tag:"div",class:"scroll_handler",parent:this.handleContainer}),this.addEvent();var t=setInterval(function(){i.container.offsetHeight&&(clearInterval(t),i.getData())},10)},this.wheel=function(t){var e,n,i;y(t)||(i=this.wheelValue,t.deltaY?(e=-t.deltaY/120,window.opera&&(e=-e)):t.detail&&(e=-t.detail/3),this.wheelData=e<0?this.wheelData>-i?this.wheelData+e:-i:this.wheelData<0?this.wheelData+e:0,n=-this.wheelData/i,this.getData(),this.movePage(n),this.moveHandler(n))},this.getData=function(){e.containerHeight=this.container.offsetHeight,e.containerWidth=this.container.offsetWidth,e.contentHeight=this.content.offsetHeight,e.contentWidth=this.content.offsetWidth,e.maxHeight=e.containerHeight-e.contentHeight,e.maxWidth=e.containerWidth-e.contentWidth,e.handler={width:this.handler.offsetWidth,height:this.handler.offsetHeight},e.barSize="vertical"===this.type?this.bar.offsetHeight-e.handler.height:this.bar.offsetWidth-e.handler.width,this.data=e},this.addEvent=function(){this.handlerEvent=new n({container:this.container,dragObj:this.handler,type:this.type,callBack:{start:function(t){i.getData()},move:function(t){i.moveHandler(i.getRate("handler")),i.movePage(i.getRate("handler"))},end:function(t){}}}),this.bar.addEventListener("click",this.clickBar.bind(this)),"touch"===this.content.getAttribute("data-scroll-content")&&(this.contentEvent=new n({container:this.container,dragObj:this.content,type:this.type,callBack:{move:function(t){var e=i.content.offsetTop,n=i.content.offsetLeft;0<e?e/=3:e<i.data.maxHeight&&(e=i.data.maxHeight+(e-i.data.maxHeight)/3),0<n?n/=3:n<i.data.maxWidth&&(n=i.data.maxWidth+(n-i.data.maxWidth)/3),"horizon"!==i.type&&(i.content.style.top=e+"px"),"vertical"!==i.type&&(i.content.style.left=n+"px"),i.moveHandler(i.getRate("content"))},end:function(t){t.isClicked||(i.moveHandler(i.getRate("content")),i.movePage(i.getRate("content")))}}})),"vertical"===this.type&&this.container.addEventListener("wheel",this.wheel.bind(this))},this.clickBar=function(t){this.getData();var e="touchmove"==t.type?t.touches[0].clientY:t.clientY,n="touchmove"==t.type?t.touches[0].clientX:t.clientX,i=this.bar.getBoundingClientRect().top,a=this.bar.getBoundingClientRect().left,h=this.bar.getBoundingClientRect().width,s=this.bar.getBoundingClientRect().height,o="vertical"===this.type?e-i:n-a,c="vertical"===this.type?o/s:o/h;this.moveHandler(c),this.movePage(c)},this.getRate=function(t){var e="handler"===t?"vertical"===this.type?this.handler.offsetTop/this.data.barSize:this.handler.offsetLeft/this.data.barSize:"vertical"===this.type?this.content.offsetTop/this.data.maxHeight:this.content.offsetLeft/this.data.maxWidth;return e},this.moveHandler=function(t){var e=t<0?0:1<=t?1:t,n=this.data.barSize*e;"horizon"!==this.type&&(this.handler.style.top=n+"px"),"vertical"!==this.type&&(this.handler.style.left=n+"px")},this.movePage=function(t){var e=t<0?0:1<=t?1:t,n="vertical"===this.type?this.data.maxHeight*e:this.data.maxWidth*e;0<n&&(n=-n),"horizon"!==this.type&&(this.content.style.top=n+"px"),"vertical"!==this.type&&(this.content.style.left=n+"px")},this.reset=function(){this.getData(),this.moveHandler(0),this.movePage(0)},this.set=function(){this.createControl()},this.set()}function n(t){var l=this,d=t.type?t.type:"all",u=t.dragObj,v=(t.dropObj?t.dropObj:document,t.container?t.container:document),e=t.callBack&&t.callBack.start?t.callBack.start:null,f=t.callBack&&t.callBack.move?t.callBack.move:null,g=t.callBack&&t.callBack.end?t.callBack.end:null;function p(){u.addEventListener("click",m,!0)}function m(){}this.startDrag=function(t){var h,s,o,c,r;function i(t){var e="touchmove"==t.type?t.touches[0].clientY:t.clientY,n="touchmove"==t.type?t.touches[0].clientX:t.clientX,i=(e-s)/h+c,a=(n-o)/h+r;l.newY=i,l.newX=a,"horizon"!==d&&(u.style.top=i+"px"),"vertical"!==d&&(u.style.left=a+"px"),f&&f(l)}function a(){var t=arguments[0],e=t.clientX||t.changedTouches[0].clientX,n=t.clientY||t.changedTouches[0].clientY;Math.abs(o-e)<50&&Math.abs(s-n)<50?(u.removeEventListener("click",m,!0),window.setTimeout(p),l.isClicked=!0):l.isClicked=!1,v.removeEventListener("mousemove",i),v.removeEventListener("touchmove",i),document.removeEventListener("mouseup",a),document.removeEventListener("touchend",a),g&&g(l)}e&&e(l),y(t)||(h=$pm.zoomRate?$pm.zoomRate:1,s="touchstart"==t.type?t.touches[0].clientY:t.clientY,o="touchstart"==t.type?t.touches[0].clientX:t.clientX,c=u.offsetTop,r=u.offsetLeft,u.style.transition="none",v.addEventListener("mousemove",i),v.addEventListener("touchmove",i),document.addEventListener("mouseup",a),document.addEventListener("touchend",a))},u.addEventListener("mousedown",this.startDrag.bind(this)),u.addEventListener("touchstart",this.startDrag.bind(this)),v.addEventListener("touchstart",function(t){t.stopPropagation()}),p()}window.$scroll=function(t){return new e(t)}}();