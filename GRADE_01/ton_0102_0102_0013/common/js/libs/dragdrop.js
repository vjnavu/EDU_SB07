function DragObj(t,e){this.dragElement=t,this.DragDrop=e,Object.defineProperties(this,{size:{get:function(){return this.dragElement.getBoundingClientRect()}},styles:{get:function(){var t=window.getComputedStyle(this.dragElement);return{position:t.position,left:parseInt(t.left),top:parseInt(t.top),width:parseInt(t.width),height:parseInt(t.height)}}},initStyles:{set:function(t){this._initStyles=t},get:function(){return this._initStyles}},dragElementStartCoordinates:{set:function(t){this._dragElementStartCoordinates=t},get:function(){return this._dragElementStartCoordinates}},disabled:{get:function(){return"complete"===this.dragElement.dataset.dragElement}},answers:{get:function(){var t=this.dragElement.dataset.dragDropAnswer;return t.includes(",")&&(t=(t=t.split(",")).map(function(t){return t.trim()})),t}}}),this.disable=function(){this.dragElement.dataset.dragElement="complete"},this.able=function(){this.dragElement.dataset.dragElement=""},this.classOn=function(){this.dragElement.style.position="",this.dragElement.style.left="",this.dragElement.style.top="",this.dragElement.classList.add("dragComplete")},this.classOff=function(){this.dragElement.classList.remove("dragComplete")},this.reset=function(){this.dragElement.style.position=this.initStyles.position,this.dragElement.style.left=this.initStyles.left+"px",this.dragElement.style.top=this.initStyles.top+"px",this.classOff(),this.able()},this.dragObjAnswer=function(){for(var t,e,n,i,s=this.answers,r=s.length,a=this.DragDrop.areaObjs,o=this.DragDrop.areaObjsLen,h=0;h<o;h++){i=(e=(t=a[h]).answers).length;for(var l=0;l<i;l++){n=e[l];for(var d=0;d<r;d++)s[d]===n&&(this.DragDrop.opts.class?this.classOn():(this.dragElement.style.position="absolute",this.dragPositioning(t)),this.disable())}}},this.checkDownEventIsOn=function(t){return this.size.left<t.x&&t.x<this.size.left+this.size.width&&this.size.top<t.y&&t.y<this.size.top+this.size.height},this.dragStart=function(t){this.dragElement.style.position="absolute",this.dragPositioning(t)},this.dragPositioning=function(t){console.log(t.constructor.name),"DropAreaObj"===t.constructor.name?(this.dragElement.style.left=t.dropSize.x+"px",this.dragElement.style.top=t.dropSize.y+"px"):(this.dragElement.style.left=this.dragElementStartCoordinates.x+(t.x-this.DragDrop.eventStartCoordinates.x)+"px",this.dragElement.style.top=this.dragElementStartCoordinates.y+(t.y-this.DragDrop.eventStartCoordinates.y)+"px")},this.dragObjEnd=function(t){var e=this.DragDrop.areaObjNow,n=this.DragDrop.isCorrect;!e||this.DragDrop.opts.answer&&!n?this.dragPositioning(this.DragDrop.eventStartCoordinates):(this.DragDrop.opts.class?this.classOn():this.dragPositioning(e),this.DragDrop.opts.disableArea&&e.disable(),this.disable()),this.DragDrop.endCallback&&this.DragDrop.endCallback({dragObj:this.DragDrop.dragObjNow,areaObj:e,isCorrect:n})}}function DropAreaObj(t,e){this.areaElement=t,this.DragDrop=e,Object.defineProperties(this,{size:{get:function(){return this.areaElement.getBoundingClientRect()}},styles:{get:function(){var t=window.getComputedStyle(this.areaElement);return{left:parseInt(t.left),top:parseInt(t.top),width:parseInt(t.width),height:parseInt(t.height)}}},dropSize:{get:function(){return{x:this.styles.left,y:this.styles.top}}},answers:{get:function(){var t=this.areaElement.dataset.dragDropAnswer;return t.includes(",")&&(t=(t=t.split(",")).map(function(t){return t.trim()})),t}},disabled:{get:function(){return"complete"===this.areaElement.dataset.dropAreaElement}}}),this.checkUpEventIsOn=function(t){return this.size.left<t.x&&t.x<this.size.left+this.size.width&&this.size.top<t.y&&t.y<this.size.top+this.size.height},this.disable=function(){this.areaElement.dataset.dropAreaElement="complete"},this.able=function(){this.areaElement.dataset.dropAreaElement=""},this.reset=function(){this.able()}}var DragDrop=function(t){this.containerElement=t.containerElement,(this.containerElement.self=this).dragElements=t.dragElements,this.areaElements=t.dropAreaElements,this.dragObjs=[],this.areaObjs=[],this.moveEventIsOutCorrection=10,this.opts={answer:!1,class:!1,disableArea:!1},Object.defineProperties(this,{dragObjsLen:{get:function(){return this.dragObjs.length}},areaObjsLen:{get:function(){return this.areaObjs.length}},containerSize:{get:function(){return this.containerElement.getBoundingClientRect()}},eventStartCoordinates:{set:function(t){this._eventStartCoordinates=t},get:function(){return this._eventStartCoordinates}},dragObjNow:{set:function(t){this._dragObjNow=t},get:function(){return this._dragObjNow}},areaObjNow:{set:function(t){this._areaObjNow=t},get:function(){return this._areaObjNow}},isCorrect:{get:function(){if(!this.opts.answer)return!0;var t,e,n,i,s;if(!this.dragObjNow||!this.areaObjNow)return!1;e=(t=this.dragObjNow.answers).length,i=(n=this.areaObjNow.answers).length;for(var r=0;r<i;r++){s=n[r];for(var a=0;a<e;a++)if(s===t[a])return!0}}}}),this.initialize=function(){this.createDragObjs(),this.createAreaObjs(),this.addDownEventHandler(),this.setOptions()},this.createDragObjs=function(){for(var t=this.dragElements.length,e=0;e<t;e++){var n=new DragObj(this.dragElements[e],this);n.initStyles=n.styles,this.dragObjs.push(n)}},this.createAreaObjs=function(){for(var t=this.areaElements.length,e=0;e<t;e++){var n=new DropAreaObj(this.areaElements[e],this);this.areaObjs.push(n)}},this.answerAll=function(){for(var t=0;t<this.dragObjsLen;t++){this.dragObjs[t].dragObjAnswer()}for(t=0;t<this.areaObjsLen;t++){this.areaObjs[t].disable()}},this.resetAll=function(){for(var t=0;t<this.dragObjsLen;t++){this.dragObjs[t].reset()}for(t=0;t<this.areaObjsLen;t++){this.areaObjs[t].reset()}},this.setOptions=function(){if(this.containerElement.hasAttribute("data-drag-drop-option")){for(var t=this.containerElement.dataset.dragDropOption,e=(t=(t=t.split(",")).map(function(t){return t.trim()})).length,n=0;n<e;n++){var i=t[n];this.opts[i]=!0}console.log("DragDrop options:\n",this.opts)}},this.addDownEventHandler=function(){this.containerElement.addEventListener("mousedown",this.downEventHandler,!1),this.containerElement.addEventListener("touchstart",this.downEventHandler,!1)},this.removeDownEventHandler=function(){this.containerElement.removeEventListener("mousedown",this.downEventHandler,!1),this.containerElement.removeEventListener("touchstart",this.downEventHandler,!1)},this.downEventHandler=function(t){var e;if(!!t.touches){if("mousedown"===t.type)return;e={x:t.touches[0].clientX,y:t.touches[0].clientY}}else{if("touchstart"===t.type)return;e={x:t.clientX,y:t.clientY}}this.self.checkDownEventIsOnDragElement(e)},this.checkDownEventIsOnDragElement=function(t){t:for(var e=0;e<this.dragObjsLen;e++){var n=this.dragObjs[e];if(n.checkDownEventIsOn(t)){this.dragStart(n,t);break t}}},this.dragStart=function(t,e){t.disabled||(this.dragObjNow=t,this.eventStartCoordinates=e,t.dragElementStartCoordinates={x:t.styles.left,y:t.styles.top},t.dragStart(e),this.addMoveEventHandler(),this.addUpEventHandler(),this.removeDownEventHandler())},this.addMoveEventHandler=function(){this.containerElement.addEventListener("mousemove",this.moveEventHandler,!1),this.containerElement.addEventListener("touchmove",this.moveEventHandler,!1)},this.removeMoveEventHandler=function(){this.containerElement.removeEventListener("mousemove",this.moveEventHandler,!1),this.containerElement.removeEventListener("touchmove",this.moveEventHandler,!1)},this.moveEventHandler=function(t){var e,n;if(!!t.touches){if("mousemove"===t.type)return;e={x:t.touches[0].clientX,y:t.touches[0].clientY}}else{if("touchmove"===t.type)return;e={x:t.clientX,y:t.clientY}}(n=this.self).dragObjNow.dragPositioning(e),n.checkMoveEventIsOut(e)&&n.dragDropEnd(e)},this.checkMoveEventIsOut=function(t){return t.x<this.containerSize.left+this.moveEventIsOutCorrection||this.containerSize.left+this.containerSize.width<t.x+this.moveEventIsOutCorrection||t.y<this.containerSize.top+this.moveEventIsOutCorrection||this.containerSize.top+this.containerSize.height<t.y+this.moveEventIsOutCorrection},this.addUpEventHandler=function(){this.containerElement.addEventListener("mouseup",this.upEventHandler,!1),this.containerElement.addEventListener("touchend",this.upEventHandler,!1)},this.removeUpEventHandler=function(){this.containerElement.removeEventListener("mouseup",this.upEventHandler,!1),this.containerElement.removeEventListener("touchend",this.upEventHandler,!1)},this.upEventHandler=function(t){var e;if(!!t.touches){if("mouseup"===t.type)return;e={x:t.touches[0].clientX,y:t.touches[0].clientY}}else{if("touchend"===t.type)return;e={x:t.clientX,y:t.clientY}}this.self.dragDropEnd(e)},this.dragDropEnd=function(t){var e=this.checkUpEventIsOnAreaElement(t).bool,n=this.checkUpEventIsOnAreaElement(t).obj;e&&(this.areaObjNow=n),this.dragObjNow.dragObjEnd(t),this.removeMoveEventHandler(),this.removeUpEventHandler(),this.addDownEventHandler(),this.dragObjNow=null,this.areaObjNow=null},this.checkUpEventIsOnAreaElement=function(t){t:for(var e=0;e<this.areaObjsLen;e++){var n=this.areaObjs[e];if(n.checkUpEventIsOn(t)&&!n.disabled)return{bool:!0,obj:n}}return{bool:!1,obj:null}}};String.prototype.includes||(String.prototype.includes=function(t,e){"use strict";return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)});