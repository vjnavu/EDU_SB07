"use strict";!function(){var e=116;function n(t,o){return parseFloat(t.toPrecision(o))}function o(t){this.container=t,this.maxZoom=this.container.hasAttribute("maxZoom")?parseInt(this.container.getAttribute("maxZoom")):2,this.zoomImg=this.container.querySelector(".zoomImgContainer"),this.zoomImgPosition={top:this.zoomImg.offsetTop,left:this.zoomImg.offsetLeft},this.zoomController=$ts.ce({tag:"div",class:"zoomController",parent:this.container}),this.container.classList.contains("vertical")?(this.zoomPlus=$ts.ce({tag:"div",class:"zoomPlus",parent:this.zoomController}),this.zoomBar=$ts.ce({tag:"div",class:"zoomBar",parent:this.zoomController}),this.zoomMinus=$ts.ce({tag:"div",class:"zoomMinus",parent:this.zoomController})):(this.zoomMinus=$ts.ce({tag:"div",class:"zoomMinus",parent:this.zoomController}),this.zoomBar=$ts.ce({tag:"div",class:"zoomBar",parent:this.zoomController}),this.zoomPlus=$ts.ce({tag:"div",class:"zoomPlus",parent:this.zoomController})),this.zoomOut=$ts.ce({tag:"div",class:"zoomOut",parent:this.zoomController}),this.zoomSpin=$ts.ce({tag:"div",class:"zoomSpin",parent:this.zoomBar}),this.zoomSpinLeft=0===this.zoomSpin.offsetLeft?9:this.zoomSpin.offsetLeft,this.zoomSpinTop=0===this.zoomSpin.offsetTop?9:this.zoomSpin.offsetTop,this.zoomSpinMaxLeft=e+this.zoomSpinLeft,this.zoomSpinMaxTop=e+this.zoomSpinTop,this.imageZoomRate=1,this.resetNotWorking=!!this.container.hasAttribute("data-no-reset"),this.zoomImg.style.position="absolute",this.addEvent=function(){new i({element:this.zoomImg,block:{top:50},target:"main"}),new i({element:this.zoomSpin,type:this.container.classList.contains("vertical")?"vertical":"horizon",limit:{left:this.zoomSpinLeft,right:this.zoomSpinMaxLeft,top:this.zoomSpinTop,bottom:this.zoomSpinMaxTop},callBack:this.changeSpin.bind(this)})},this.zoomPlus.addEventListener("click",this.plusZoom.bind(this)),this.zoomMinus.addEventListener("click",this.minusZoom.bind(this)),this.zoomOut.addEventListener("click",this.resetZoom.bind(this)),this.zoomPlus.addEventListener("click",$efSound.click),this.zoomMinus.addEventListener("click",$efSound.click),this.zoomOut.addEventListener("click",$efSound.click),this.container.addEventListener("mouseover",this.addWheelEvent.bind(this)),this.container.addEventListener("mouseout",this.removeWheelEvent.bind(this)),this.addEvent()}function t(t){var o;t.wheelDelta?(o=event.wheelDelta,window.opera&&(o=-o)):t.detail&&(o=-event.detail/3),o<0?this.minusZoom():this.plusZoom()}function i(t){var g=t.element,f=t,z=f.type?f.type:"all";this.startDrag=function(t){function o(t){var o=t.clientX-c,i=t.clientY-p,e="",e="main"===d?a+i:a-i,n=(l+o)/($pm.zoomRate||1);"horizon"!==z&&(s.top&&e<s.top?e=s.top:s.bottom&&s.bottom<e&&(e=s.bottom),g.style.top=e+"px"),"vertical"!==z&&(s.left&&n<s.left?n=s.left:s.right&&s.right<n&&(n=s.right),g.style.left=n+"px"),m&&m(g)}var s={top:f.limit&&f.limit.top?f.limit.top:null,left:f.limit&&f.limit.left?f.limit.left:null,right:f.limit&&f.limit.right?f.limit.right:null,bottom:f.limit&&f.limit.bottom?f.limit.bottom:null},i={top:0,left:0,right:0,bottom:0},m=f.callBack?f.callBack:null,a=g.offsetTop,l=g.offsetLeft,e=g.getBoundingClientRect().top,n=g.getBoundingClientRect().left,h=g.getBoundingClientRect().left+g.getBoundingClientRect().width,r=g.getBoundingClientRect().top+g.getBoundingClientRect().height,c=t.clientX,p=t.clientY,d=f.target,u=function(t){document.removeEventListener("mousemove",o),document.removeEventListener("touchmove",o),document.removeEventListener("mouseup",u),document.removeEventListener("touchend",u)};f.block&&(i={top:f.block.top?f.block.top:0,left:f.block.left?f.block.left:0,right:f.block.right?f.block.right:0,bottom:f.block.bottom?f.block.bottom:0}),t.clientX<n+i.left||t.clientX>h-i.right||t.clientY<e+i.top||t.clientY>r-i.bottom?u(t):(document.addEventListener("mousemove",o),document.addEventListener("touchmove",o),document.addEventListener("mouseup",u),document.addEventListener("touchend",u))},g.addEventListener("mousedown",this.startDrag.bind(this)),g.addEventListener("touchstart",this.startDrag.bind(this))}o.prototype.addWheelEvent=function(){window.addEventListener&&window.addEventListener("DOMMouseScroll",t),window.onmousewheel=document.onmousewheel=t.bind(this)},o.prototype.removeWheelEvent=function(){window.addEventListener&&window.removeEventListener("DOMMouseScroll",t)},o.prototype.plusZoom=function(){this.imageZoomRate=this.imageZoomRate>=this.maxZoom?this.maxZoom:n(this.imageZoomRate+.1,2),this.changeSpin()},o.prototype.minusZoom=function(){this.imageZoomRate=this.imageZoomRate<=1?1:n(this.imageZoomRate-.1,2),this.changeSpin()},o.prototype.changeZoomImage=function(){this.zoomImg.style.transform="scale("+this.imageZoomRate+")",this.zoomImg.style.MsTransform="scale("+this.imageZoomRate+")",this.zoomImg.style.MozTransform="scale("+this.imageZoomRate+")",this.zoomImg.style.WebkitTransform="scale("+this.imageZoomRate+")",1===this.imageZoomRate?(this.resetPosition(),this.zoomImg.classList.add("pointerOff")):this.zoomImg.classList.remove("pointerOff")},o.prototype.changeSpin=function(t){var o,i;this.container.classList.contains("vertical")?(void 0!==t&&(this.imageZoomRate=(t.offsetTop-this.zoomSpinTop)/e+1),o=this.zoomSpinTop+e*n((this.imageZoomRate-1)/(this.maxZoom-1),2),this.zoomSpin.style.top=this.zoomSpinMaxTop<=o?this.zoomSpinMaxTop+"px":o+"px"):(void 0!==t&&(this.imageZoomRate=(t.offsetLeft-this.zoomSpinLeft)/e+1),i=this.zoomSpinLeft+e*n((this.imageZoomRate-1)/(this.maxZoom-1),2),this.zoomSpin.style.left=this.zoomSpinMaxLeft<=i?this.zoomSpinMaxLeft+"px":i+"px"),this.changeZoomImage()},o.prototype.resetPosition=function(){this.zoomImg.style.top=this.zoomImgPosition.top+"px",this.zoomImg.style.left=this.zoomImgPosition.left+"px"},o.prototype.resetZoom=function(){this.imageZoomRate=1,this.changeSpin()},window.$zoom=function(t){return new o(t)}}();